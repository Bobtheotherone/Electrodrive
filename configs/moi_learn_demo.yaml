exp_name: "moi_learn_demo"
seed: 42
device: "cuda"
train_dtype: "float32"

curriculum:
  geometry_weights:
  plane: 0.5
  sphere: 0.5
  cylinder2D: 0.0
  parallel_planes: 0.0
include_pdf_sources: false
pdf_paths: []

dataset:
  n_train_problems: 200
  n_val_problems: 40
  samples_per_problem_jit: 2048
  ratio_boundary: 0.4
  ratio_interior: 0.6
  supervision_mode: "analytic"   # use closed-form images only
  bem_oracle_config: {}          # unused in analytic mode

model:
  model_type: "moi_symbolic"     # learns image systems directly
  params:
    max_images: 8
    hidden_dim: 256

trainer:
  max_epochs: 5                  # small smoke run
  batch_size: 65536
  learning_rate: 1.0e-4
  lr_scheduler: "cosine"
  weight_decay: 1.0e-5
  grad_clip_norm: 1.0
  use_amp: true
  loss_weights:
    bc_dirichlet: 50.0
    pde_residual: 1.0
    sparsity: 1.0e-4
  log_every_n_steps: 10
  val_every_n_epochs: 1
  ckpt_every_n_epochs: 5
  early_stopping_patience: 10

evaluation:
  eval_dtype: "float64"
  n_samples_bc: 1024
  n_samples_pde: 512
  tolerances_override: {}
  split: "val"

